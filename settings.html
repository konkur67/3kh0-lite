<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Settings | Network Unity</title>
  <link rel="icon" href="/favicon.ico" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: #000000;
      color: #ffffff;
      min-height: 100vh;
      padding: 60px 40px;
      position: relative;
    }

    .stars {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 1;
      pointer-events: none;
    }

    .star {
      position: absolute;
      width: 1px;
      height: 1px;
      background: white;
      border-radius: 50%;
      box-shadow: 0 0 2px rgba(255, 255, 255, 0.5);
      animation: twinkle 4s infinite;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.2; }
      50% { opacity: 1; }
    }

    .content {
      position: relative;
      z-index: 2;
      max-width: 700px;
      margin: 0 auto;
    }

    h1 {
      font-size: 3.5rem;
      font-weight: 700;
      letter-spacing: -2px;
      margin-bottom: 50px;
      text-align: center;
      transition: all 0.3s ease;
      text-shadow: 0 0 40px rgba(255, 255, 255, 0.3),
                   0 0 80px rgba(255, 255, 255, 0.1);
    }

    h1:hover {
      text-shadow: 0 0 60px rgba(255, 255, 255, 0.5),
                   0 0 100px rgba(255, 255, 255, 0.2);
    }

    .section {
      background: rgba(20, 20, 20, 0.8);
      backdrop-filter: blur(10px);
      border: 1px solid #222;
      color: #ffffff;
      padding: 24px;
      margin-bottom: 20px;
      border-radius: 12px;
      transition: all 0.3s ease;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
    }

    .section:hover {
      background: rgba(30, 30, 30, 0.9);
      border-color: #333;
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.05);
    }

    .section h2 {
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 16px;
      letter-spacing: -1px;
    }

    select {
      width: 100%;
      padding: 14px 16px;
      border: 1px solid #333;
      background: rgba(30, 30, 30, 0.8);
      color: #ffffff;
      font-family: 'Inter', sans-serif;
      font-size: 0.95rem;
      outline: none;
      cursor: pointer;
      transition: all 0.3s ease;
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.05);
    }

    select:focus {
      border-color: #555;
      background: rgba(40, 40, 40, 0.9);
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
    }

    select:hover {
      border-color: #444;
    }

    select option {
      background: #1a1a1a;
      color: #ffffff;
    }

    .btn {
      width: 100%;
      padding: 14px;
      background: rgba(40, 40, 40, 0.8);
      color: #ffffff;
      border: 1px solid #444;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.95rem;
      font-weight: 600;
      margin-top: 12px;
      transition: all 0.3s ease;
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.05);
    }

    .btn:hover {
      background: rgba(60, 60, 60, 0.9);
      border-color: #666;
      transform: translateY(-2px);
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
    }

    .btn:active {
      transform: translateY(0);
    }

    .back-btn {
      display: inline-block;
      padding: 12px 32px;
      background: rgba(40, 40, 40, 0.8);
      color: #ffffff;
      border: 1px solid #444;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      margin-bottom: 30px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.05);
    }

    .back-btn:hover {
      background: rgba(60, 60, 60, 0.9);
      border-color: #666;
      transform: translateY(-2px);
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
    }

    .status {
      margin-top: 12px;
      padding: 12px;
      background: rgba(60, 60, 60, 0.8);
      color: #ffffff;
      font-size: 0.9rem;
      display: none;
      text-align: center;
      border-radius: 8px;
      border: 1px solid #444;
    }

    .status.show {
      display: block;
    }

    .buttons-center {
      text-align: center;
      margin-top: 40px;
    }

    @media (max-width: 768px) {
      body {
        padding: 40px 20px;
      }

      h1 {
        font-size: 2.5rem;
      }

      .section {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="stars" id="stars"></div>
  
  <div class="content">
    <h1>Settings.</h1>

    <div class="section">
      <h2>Theme</h2>
      <select id="themeSelect" onchange="applyTheme()">
        <option value="default">Black & White (Default)</option>
        <option value="dark">Dark Gray</option>
        <option value="blue">Blue & Black</option>
        <option value="green">Green & Black</option>
        <option value="purple">Purple & Black</option>
        <option value="red">Red & Black</option>
      </select>
      <div class="status" id="themeStatus"></div>
    </div>

    <div class="section">
      <h2>Tab Cloak</h2>
      <select id="cloakSelect" onchange="applyCloakFromDropdown()">
        <option value="">Select preset...</option>
        <option value="google">Google</option>
        <option value="drive">Google Drive</option>
        <option value="docs">Google Docs</option>
        <option value="gmail">Gmail</option>
        <option value="youtube">YouTube</option>
        <option value="clever">Clever</option>
        <option value="canvas">Canvas</option>
        <option value="schoology">Schoology</option>
      </select>
      <button class="btn" onclick="resetCloak()">Reset to Default</button>
      <div class="status" id="cloakStatus"></div>
    </div>

    <div class="section">
      <h2>About:blank Cloak</h2>
      <button class="btn" ondblclick="openAboutBlank()">Double-Click to Activate</button>
      <div class="status" id="blankStatus"></div>
    </div>

    <div class="section">
      <h2>Blob URL Cloak</h2>
      <button class="btn" ondblclick="openBlobCloak()">Double-Click to Activate</button>
      <div class="status" id="blobStatus"></div>
    </div>

    <div class="buttons-center">
      <a href="/index.html" class="back-btn">Back to Home</a>
    </div>
  </div>

  <script>
    function createStars() {
      const starsContainer = document.getElementById('stars');
      const starCount = 150;
      
      for (let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.animationDelay = Math.random() * 4 + 's';
        star.style.animationDuration = (Math.random() * 4 + 3) + 's';
        starsContainer.appendChild(star);
      }
    }

    createStars();

    const cloaks = {
      google: { title: 'Google', favicon: 'https://www.google.com/favicon.ico' },
      drive: { title: 'Google Drive', favicon: 'https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png' },
      docs: { title: 'Google Docs', favicon: 'https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico' },
      gmail: { title: 'Gmail', favicon: 'https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico' },
      youtube: { title: 'YouTube', favicon: 'https://www.youtube.com/favicon.ico' },
      clever: { title: 'Clever', favicon: 'https://clever.com/favicon.ico' },
      canvas: { title: 'Canvas', favicon: 'https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico' },
      schoology: { title: 'Schoology', favicon: 'https://asset-cdn.schoology.com/sites/all/themes/schoology_theme/favicon.ico' }
    };

    function applyCloakFromDropdown() {
      const select = document.getElementById('cloakSelect');
      const key = select.value;
      if (key && cloaks[key]) {
        setCloak(cloaks[key].title, cloaks[key].favicon);
        showStatus('cloakStatus', `Tab cloaked as ${cloaks[key].title}`);
      }
    }

    function setCloak(title, favicon) {
      document.title = title;
      setFavicon(favicon);
      localStorage.setItem('cloakTitle', title);
      localStorage.setItem('cloakFavicon', favicon);
      
      if (window.parent !== window) {
        try {
          window.parent.document.title = title;
          const parentLink = window.parent.document.querySelector("link[rel*='icon']");
          if (parentLink) {
            parentLink.href = favicon;
          }
        } catch(e) {}
      }
    }

    function resetCloak() {
      document.title = 'Settings | Network Unity';
      setFavicon('/favicon.ico');
      localStorage.removeItem('cloakTitle');
      localStorage.removeItem('cloakFavicon');
      document.getElementById('cloakSelect').value = '';
      showStatus('cloakStatus', 'Tab cloak reset to default');
      
      if (window.parent !== window) {
        try {
          window.parent.document.title = 'Network Unity';
          const parentLink = window.parent.document.querySelector("link[rel*='icon']");
          if (parentLink) {
            parentLink.href = '/favicon.ico';
          }
        } catch(e) {}
      }
    }

    function setFavicon(url) {
      let link = document.querySelector("link[rel*='icon']") || document.createElement('link');
      link.type = 'image/x-icon';
      link.rel = 'shortcut icon';
      link.href = url;
      document.getElementsByTagName('head')[0].appendChild(link);
    }

    function openAboutBlank() {
      const popup = window.open('about:blank', '_blank');
      if (popup) {
        popup.document.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <title>${localStorage.getItem('cloakTitle') || 'Google'}</title>
            <link rel="icon" href="${localStorage.getItem('cloakFavicon') || 'https://www.google.com/favicon.ico'}">
          </head>
          <body style="margin:0;padding:0;overflow:hidden;">
            <iframe src="${window.location.href}" style="width:100%;height:100vh;border:none;"></iframe>
          </body>
          </html>
        `);
        popup.document.close();
        showStatus('blankStatus', 'Opened - close this tab');
      } else {
        showStatus('blankStatus', 'Popup blocked');
      }
    }

    function openBlobCloak() {
      const html = `
        <!DOCTYPE html>
        <html>
        <head>
          <title>${localStorage.getItem('cloakTitle') || 'Google'}</title>
          <link rel="icon" href="${localStorage.getItem('cloakFavicon') || 'https://www.google.com/favicon.ico'}">
        </head>
        <body style="margin:0;padding:0;overflow:hidden;">
          <iframe src="${window.location.href}" style="width:100%;height:100vh;border:none;"></iframe>
        </body>
        </html>
      `;
      const blob = new Blob([html], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const popup = window.open(url, '_blank');
      if (popup) {
        showStatus('blobStatus', 'Opened - close this tab');
      } else {
        showStatus('blobStatus', 'Popup blocked');
      }
    }

    function showStatus(elementId, message) {
      const status = document.getElementById(elementId);
      status.textContent = message;
      status.classList.add('show');
      setTimeout(() => {
        status.classList.remove('show');
      }, 3000);
    }

    window.onload = function() {
      const savedTitle = localStorage.getItem('cloakTitle');
      const savedFavicon = localStorage.getItem('cloakFavicon');
      if (savedTitle && savedFavicon) {
        document.title = savedTitle;
        setFavicon(savedFavicon);
      }
      
      const savedTheme = localStorage.getItem('siteTheme');
      if (savedTheme) {
        document.getElementById('themeSelect').value = savedTheme;
      }
    };

    function applyTheme() {
      const theme = document.getElementById('themeSelect').value;
      localStorage.setItem('siteTheme', theme);
      showStatus('themeStatus', `Theme changed to ${theme} - Refreshing...`);
      
      setTimeout(() => {
        if (window.parent !== window) {
          window.parent.location.reload();
        } else {
          window.location.reload();
        }
      }, 500);
    }
  </script>
</body>
</html>
